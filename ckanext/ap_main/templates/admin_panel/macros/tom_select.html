{% from "macros/form/input_block.html" import input_block %}
{% from "macros/form/attributes.html" import attributes %}

{#
    tomselect select macro, adds the data-module attribute to the select element and settings argument

    selected - list of selected values
    options - list of dictionaries with keys value and text
#}

{% macro tom_select(name, id='', label='', options=[], selected=[], error='', classes=[], attrs={}, settings={}, is_required=false) %}
    {% set classes = (classes|list) %}
    {% do classes.append('control-select') %}

    {%- set extra_html = caller() if caller -%}

    {% call input_block(id or name, label or name, error, classes, extra_html=extra_html, is_required=is_required) %}
        <select id="{{ id or name }}" name="{{ name }}" data-module='ap-tom-select' {{ attributes(attrs) }} {{ attributes(settings) }}>
            {% for option in options %}
                <option value="{{ option.value }}" {{ selected if option.value in selected }}>
                    {{ option.text or option.value }}
                </option>
            {% endfor %}
        </select>
    {% endcall %}
{% endmacro %}
