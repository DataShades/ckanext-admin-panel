{% from 'admin_panel/macros/attributes.html' import attributes %}

<tr>
    {% if bulk_check %}
        <td class="checkbox-cell checkbox-cell-row">
            <input type="checkbox" name="entity_id" id="entity_id" value="{{ item.id }}">
        </td>
    {% endif %}

    {% for col in columns %}
        <td>
            {% if col.column_renderer.__name__ != "action_render" %}
                {{ col.column_renderer(items, item, item[col.name], **col.renderer_kwargs) | safe }}
            {% else %}
                {% for action in col.actions %}
                    {% set params = {} %}

                    {% for k, v in action.params.items() %}
                        {% if v[0] == "$" %}
                            {% do params.update({k: item[v[1:]]}) %}
                        {% else %}
                            {% do params.update({k: v}) %}
                        {% endif %}
                    {% endfor %}

                    {% if "class" not in action.attributes %}
                        {% do action.attributes.update(class="btn btn-primary") %}
                    {% endif %}

                    <a href="{{  h.url_for(action.endpoint, **params) }}" {{ attributes(item, action.attributes) }}>
                        {{ action.label or "" }}
                        {% if action.icon %}
                            <i class="{{ action.icon }}"></i>
                        {% endif %}
                    </a>
                {% endfor %}
            {% endif %}
        </td>
    {% endfor %}
</tr>
