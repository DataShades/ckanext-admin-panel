{% import 'macros/form.html' as form %}

<!-- Modal -->
<div class="modal fade" id="add-cron-job" class="add-cron-job-modal" aria-labelledby="add-cron-job-label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="add-cron-job-label">{{ _("Adding a cron job")}}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div> <!-- .modal-header -->

            <div class="modal-body">
                {{ form.input("name", label=_("Name"), attrs={"required": "required", "class": "form-control"}) }}

                {{ form.input('actions', label=_('Actions'), error=error, attrs={"multiple": "multiple", "data-module": "autocomplete", "data-module-source": h.url_for('ap_cron.action_autocomplete', incomplete="?"), "data-module-tags": ""}) }}

                {% call form.textarea("job_data", label=_("Data"), value="{}", attrs={"data-module": "ap-jsonlint", "data-module-input": "#job_data", "data-module-result":"#validation-result"}) %}
                    <div id="validation-result"></div>
                {% endcall %}

                {{ form.input("timeout", label=_("Job timeout"), type='number', attrs={"step": "1", "pattern": "\d+", "class": "form-control"}, value=h.ap_cron_get_job_timeout()) }}

                <div class="quick-schedule mb-4">
                    <label style="display: block">{{ _("Quick Schedule") }}</label>
                    <a class="btn btn-primary" _="on click set #schedule.value to '@reboot'">{{ _("Startup") }}</a>
                    <a class="btn btn-primary" _="on click set #schedule.value to '@hourly'">{{ _("Hourly") }}</a>
                    <a class="btn btn-primary" _="on click set #schedule.value to '@daily'">{{ _("Daily") }}</a>
                    <a class="btn btn-primary" _="on click set #schedule.value to '@weekly'">{{ _("Weekly") }}</a>
                    <a class="btn btn-primary" _="on click set #schedule.value to '@monthly'">{{ _("Monthly") }}</a>
                    <a class="btn btn-primary" _="on click set #schedule.value to '@yearly'">{{ _("Yearly") }}</a>

                </div>

                <div class="row">
                    <div class="col-md-2">{{ _("Minute") }}</div>
                    <div class="col-md-2">{{ _("Hour") }}</div>
                    <div class="col-md-2">{{ _("Day") }}</div>
                    <div class="col-md-2">{{ _("Month") }}</div>
                    <div class="col-md-2">{{ _("Week") }}</div>
                </div>

                <div class="row">
                    <div class="col-md-2">
                        <input type="text" class="form-control" id="job-minute" value="*">
                    </div>

                    <div class="col-md-2">
                        <input type="text" class="form-control" id="job-hour" value="*">
                    </div>

                    <div class="col-md-2">
                        <input type="text" class="form-control" id="job-day" value="*">
                    </div>

                    <div class="col-md-2">
                        <input type="text" class="form-control" id="job-month" value="*">
                    </div>

                    <div class="col-md-2">
                        <input type="text" class="form-control" id="job-week" value="*">
                    </div>

                    <div class="col-md-2"><a class="btn btn-primary" _="on click call ckan.setSchedule('#schedule')">Set</a></div>
                </div>

                {{ form.input("schedule", label=_("Schedule"), attrs={"readonly": 1, "required": 1, "class": "form-control"}) }}
            </div> <!-- .modal-body -->

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{{ _("Cancel") }}</button>
                <button type="submit" class="btn btn-primary">{{ _("Add") }}</button>
            </div> <!-- .modal-footer -->
        </div> <!-- .modal-content -->
    </div> <!-- .modal-dialog -->
</div> <!-- .modal -->
