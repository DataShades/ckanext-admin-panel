{% from 'admin_panel/macros/attributes.html' import attributes %}

{% set job_running = h.ap_cron_is_job_running(item) %}

<tr>
    {% if bulk_check %}
        <td class="checkbox-cell checkbox-cell-row">
            <input type="checkbox" name="entity_id" id="entity_id" value="{{ item.id }}">
        </td>
    {% endif %}

    {% for col in columns %}
        <td>
            {% if col.column_renderer.__name__ != "action_render" %}
                {{ col.column_renderer(items, item, item[col.name], **col.renderer_kwargs) | safe }}
            {% else %}
                <a class="btn btn-black" href="{{ h.url_for('ap_report.logs', type=h.ap_cron_get_cron_logger_name(), q=item.id) }}">{{ _("Logs") }}</a>

                <div style="display:inline-block; cursor:pointer;" {% if job_running %}data-module="ap-tooltip" title="{{ _('You can\'t edit a running job.') }}"{% endif %}>
                    <a
                        class="btn btn-primary {{ 'disabled' if job_running }}"
                        href="{{ '#' if job_running else h.url_for('ap_cron.get_edit_form', job_id=item.id) }}"

                        {#} block editing while task is running {#}
                        {% if not job_running %}
                            data-bs-toggle= "modal",
                            data-bs-target= "#edit-cron-job",
                            hx-target="#edit-cron-job .modal-body",
                            hx-trigger="click",
                            hx-get="{{ h.url_for('ap_cron.get_edit_form', job_id=item.id) }}"
                        {% endif %}>
                        {{ _("Edit") }}
                    </a>
                </div>

                <div style="display:inline-block; cursor:pointer;" {% if job_running %}data-module="ap-tooltip" title="{{ _('You can\'t start a running job.') }}"{% endif %}>
                    <a class="btn btn-primary {{ 'disabled' if job_running }}" href="{{ '#' if job_running else h.url_for('ap_cron.run', job_id=item.id) }}">
                        <i class="fa fa-play"></i>
                    </a>
                </div>

                <div style="display:inline-block; cursor:pointer;" {% if job_running %}data-module="ap-tooltip" title="{{ _('You can\'t remove a running job.') }}"{% endif %}>
                    <a
                    class="btn btn-danger {{ 'disabled' if job_running }}"
                    href="{{ '#' if job_running else h.url_for('ap_cron.run', job_id=item.id) }}"
                    {% if not job_running %}hx-swap="none" hx-trigger="click" hx-post="{{ h.url_for('ap_cron.delete', job_id=item.id) }}"{% endif %}>
                        <i class="fa fa-trash-alt"></i>
                    </a>
                </div>

            {% endif %}
        </td>
    {% endfor %}
</tr>
